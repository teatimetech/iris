# Production Environment Values
# These values override the base Helm chart values for the production environment

# Common environment configuration
environment: prod

# Image pull configuration
imagePullPolicy: IfNotPresent

# Replica counts (high availability)
replicaCount:
  api-gateway: 5
  agent-router: 3
  web-ui: 5

# Resource limits (production)
resources:
  api-gateway:
    limits:
      cpu: 4000m
      memory: 4Gi
    requests:
      cpu: 1000m
      memory: 1Gi

  agent-router:
    limits:
      cpu: 8000m
      memory: 8Gi
    requests:
      cpu: 2000m
      memory: 2Gi

  web-ui:
    limits:
      cpu: 2000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 512Mi

# Auto-scaling enabled with conservative settings
autoscaling:
  enabled: true
  minReplicas: 5
  maxReplicas: 20
  targetCPUUtilizationPercentage: 50
  targetMemoryUtilizationPercentage: 70

# Database configuration (production)
postgresql:
  auth:
    database: iris_db_prod
    username: iris_user_prod
  persistence:
    size: 200Gi
    storageClass: fast-ssd
  backup:
    enabled: true
    schedule: "0 */6 * * *" # Every 6 hours
    retention: 30 # days
  replication:
    enabled: true
    readReplicas: 2

# Ingress configuration
ingress:
  enabled: true
  className: nginx
  hosts:
    - host: iris.example.com
      paths:
        - path: /
          pathType: Prefix
    - host: www.iris.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: iris-prod-tls
      hosts:
        - iris.example.com
        - www.iris.example.com
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"

# Service type
service:
  type: ClusterIP

# Logging level
logging:
  level: warn

# Feature flags for production
features:
  enableDebug: false
  enableMetrics: true
  enableTracing: true
  enableAlerts: true

# Pod disruption budget
podDisruptionBudget:
  enabled: true
  minAvailable: 2

# Network policy
networkPolicy:
  enabled: true
  policyTypes:
    - Ingress
    - Egress

# Security
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000
  seccompProfile:
    type: RuntimeDefault
